from pygame import * 
from random import randint 
from time import time as  timer

mixer.init() 
mixer.music.load('space.ogg') 
mixer.music.play() 
fire_sound = mixer.Sound('fire.ogg') 

#! я зделел кхутые кахтинки 
img_back = "map.png" #фон игры 
img_hero = "shelly.jpg" #герой  
font.init() 
font2 = font.SysFont('Arial', 35)    
font1 = font.SysFont('Arial',80) 
win = font1.render('You win', True, (255,255,255)) 
lose = font1.render('You lose', True,(255,255,255)) 
score = 0 
last = 0 
goal = 100
max_lost = 3 
non_fire = 0 
#todo это батя
class GameSprite(sprite.Sprite): 
#?это лего
    def __init__(self, player_image, player_x, player_y, size_x, size_y, player_speed): 
        sprite.Sprite.__init__(self) 
        self.image = transform.scale(image.load(player_image), (size_x, size_y)) 
        self.speed = player_speed 
        self.rect = self.image.get_rect() 
        self.rect.x = player_x 
        self.rect.y = player_y 
#! это пэинт
    def reset(self): 
        window.blit(self.image, (self.rect.x, self.rect.y)) 


#?думает что главный герой
class Player(GameSprite): 

    def update(self): 
        keys = key.get_pressed() 
        if keys[K_LEFT] and self.rect.x > 5: 
            self.rect.x -= self.speed 
        if keys[K_RIGHT] and self.rect.x < win_width - 80: 
            self.rect.x += self.speed 
#!он стреляет
    def fire(self): 
        bullet = Bullet('pdtron.jpg',self.rect.centerx,self.rect.top,15,20,-15) 
        bullets.add(bullet) 
class Enemy(GameSprite): 
    def update(self): 
        self.rect.y += self.speed 
        global lost 
        if self.rect.y > 500: 
            self.rect.x = randint(80,win_width-80) 
            self.rect.y = 0 
            lost += 1 
#? это патрон(пес)
class Bullet(GameSprite): 
    def update(self): 
        self.rect.y +=self.speed 
        if self.rect.y <0:
            self.kill() 

#ToDO: окно(можно прыгнуть)
win_width = 700 
win_height = 500 
display.set_caption("Shooter") 
window = display.set_mode((win_width, win_height)) 
background = transform.scale(image.load(img_back), (win_width, win_height)) 
real_time = False 

# 
ship = Player(img_hero, 5, win_height - 100, 80, 100, 10) 
monsters = sprite.Group() 
asteroid = sprite.Group()
for i in range(10): 
    monster = Enemy('mortis.jpg',randint(80,win_width-80),-40,80,50,randint(1,10)) 
    monsters.add(monster) 
for i in range(5): 
    monster = Enemy('ddd.webp',randint(80,win_width-80),-40,80,50,randint(1,5)) 
    monsters.add(monster) 

bullets = sprite.Group() 
finish = False 
run = True #флаг сбрасывается кнопкой закрытия окна 
while run: 
    for e in event.get(): 
        if e.type == QUIT: 
            run = False 
        elif e.type == KEYDOWN: 
            if e.key == K_SPACE:
                if non_fire < 5 and real_time == False:
                    non_fire += 1
                fire_sound.play() 
                ship.fire() 
                if non_fire >= 5 and real_time == False:
                    last_time = timer()
                non_fire += 1                
    if not finish: 


        window.blit(background,(0,0)) 
        text = font2.render('Счет ' + str(score), 1,(255,255,255)) 
        window.blit(text,(10,20)) 

    text_lose = font2.render('Пропущено ' + str(last),1,(255,255,255)) 
    window.blit(text_lose,(10,50)) 
    #производим движения спрайтов 
    ship.update() 
    #обновляем их в новом местоположении при каждой итерации цикла 
    ship.reset()      
    monsters.update() 
    monsters.draw(window) 
    asteroid.update()
    asteroid.draw(window)
    bullets.update() 
    bullets.draw(window) 
    collides = sprite.groupcollide(monsters,bullets,True,True) 
    if real_time == True:
        non_time = timer()
        if non_time == lost_time <3:
            reload = font2.render('Wait reload',1,(255,0,0))
            window.blit(reload)
    for c in collides: 
        score += 1 
        monster = Enemy('ufo.png',randint(80,win_width-80),-40,80,50,randint(1,5)) 
        monsters.add(monster) 
    if sprite.spritecollide(ship,monsters,False) or last>=3: 
        finish == True
        window.blit(lose,(200,200)) 
    if score >= goal: 
        finish == True 
        window.blit(win,(200,200)) 
    
    display.update()
    time.delay(50)





































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































1488